---
layout: default
permalink: /scheduled_sampling
---


<div id="detail">
  <h1 class="title">Scheduled Sampling for Transformer</h1>  
  <div class="post">


<!-- Project Desc -->    
    <h2>1. &hairsp; Project Desc</h2>

      <div class="half-spacer"></div>
      <h3>Exposure Bias</h3>
      <div class="small-spacer"></div>

      <p>
        &nbsp; RNN에서는 Exposure Bias를 완화하기 위한 방법으로 Scheduled Sampling이라는 기법을 사용합니다.
        이는 Teacher Forcing에 지나치게 의존하면서, Exposure Bias 문제가 커지는 것을 방지하기 위한 하나의 방식입니다.

        RNN에서 Scheduled Sampling의 효과는 입증되었습니다. RNN에서는 순차적으로 데이터를 처리하기에, Scheduled Sampling을 적용하는 것이 직관적인 반면.
        하지만 Transformer에서는 병렬적으로 데이터를 처리하기 때문에 Scheduled Sampling의 적용이 직관적이지 않습니다.

        이번 프로젝트에서는 "Scheduled Sampling for Transformers" 논문에서 소개된 방식을 적용해보며, Scheduled Sampling 방식의 효용성에 대해 검증해봅니다.
      </p>

      <div class="spacer"></div>
      <h3>Teacher Forcing Training</h3>
      <div class="small-spacer"></div>

      <p>
        &nbsp; 현재 다양한 딥러닝 모델들이 다양한 분야에서 좋은 성능을 보여주고 있습니다. 
        성능이 뛰어난, 모델을 사용하기 위해서는 사용자의 의도에 맞는 Down Stream Task Dataset에 맞춰 파인튜닝이 이뤄져야 합니다.
        대규모 모델의 경우, 파인튜닝을 위한 자원도 많이 필요합니다.
        모델의 성능을 포기하는 방법대신, 효율적인 학습방식으로 이 한계를 극복할수 있습니다.
        이 프로젝트에서는 네가지 대표적인 효율적 모델 학습 방법론을 살펴보고, 실제 Sequence Classification Task에서의 효용성을 통해
        각 방법론 별 효용성을 비교 분석해봅니다.
      </p>

      <div class="spacer"></div>
      <h3>Scheduled Sampling</h3>
      <div class="small-spacer"></div>

      <p>
        &nbsp; 현재 다양한 딥러닝 모델들이 다양한 분야에서 좋은 성능을 보여주고 있습니다. 
        성능이 뛰어난, 모델을 사용하기 위해서는 사용자의 의도에 맞는 Down Stream Task Dataset에 맞춰 파인튜닝이 이뤄져야 합니다.
        대규모 모델의 경우, 파인튜닝을 위한 자원도 많이 필요합니다.
        모델의 성능을 포기하는 방법대신, 효율적인 학습방식으로 이 한계를 극복할수 있습니다.
        이 프로젝트에서는 네가지 대표적인 효율적 모델 학습 방법론을 살펴보고, 실제 Sequence Classification Task에서의 효용성을 통해
        각 방법론 별 효용성을 비교 분석해봅니다.
      </p>



<!-- Experimental Setup -->    
    <h2>2. Experimental Setup</h2>

      <div class="small-spacer"></div>
      <h3>Data Setup</h3>
      <p>Sequence Classification을 위한 대표적 데이터 셋 중하나인 AG_News를 사용.
        데이터의 크기는 Train/ Valid/ Test 1000/ 100/ 100으로 설정
        총 네가지 데이터 Label을 모든 데이터에서 고르게 분배해서 한쪽으로 치우치지 않도록 가공
      </p>

      <div class="spacer"></div>
      <h3>Model Setup</h3>
      <p>대표적인 PreTrained Model인 BERT를 사용.
      </p>


      <div class="spacer"></div>
      <h3>Training Setup</h3>
      <div class="small-spacer"></div>

      <div class="code-container">
        <div class="code-snippet">
          <pre><code class="python">
TrainingArguments(
        output_dir= f'ckpt/{strategy}',
        num_train_epochs= 5,
        learning_rate= 1e-5,
        per_device_train_batch_size= 32,
        per_device_eval_batch_size= 32,
        lr_scheduler_type='reduce_lr_on_plateau',
        load_best_model_at_end= True,

        save_strategy= 'epoch',
        logging_strategy= 'epoch',
        evaluation_strategy= 'epoch',

        fp16= True if config.strategy in ['fp16', 'all'] else False,
        fp16_opt_level= '02' if config.strategy in ['fp16', 'all'] else '01',
        gradient_accumulation_steps = True if config.strategy in ['grad_accumulation', 'all'] else 4,
        gradient_checkpointing= True if config.strategy in ['grad_checkpointing', 'all'] else False,
        optim = 'adafactor' if config.strategy in ['optim', 'all'] else 'adamw_torch'
)
          </code></pre>
        </div>
      </div>


<!-- Result -->    
    <h2>3. Result</h2>
    <div class="small-spacer"></div>
    <table class="result-table">
      
      <thead>
        <tr>
          <th>Sampling Ratio</th>
          <th>Machine Translation</th>
          <th>Dialogue Generation</th>
          <th>Text Summarization</th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>Sampling 0</td>
          <td>-</td>
          <td>-</td>
          <td>-</td>
        </tr>
      
        <tr>
          <td>Sampling 0.1</td>
          <td>결과2-1</td>
          <td>결과2-2</td>
          <td>결과2-3</td>
        </tr>
      
        <tr>
          <td>Sampling 0.3</td>
          <td>결과2-1</td>
          <td>결과2-2</td>
          <td>결과2-3</td>
        </tr>

        <tr>
          <td>Sampling 0.5</td>
          <td>결과2-1</td>
          <td>결과2-2</td>
          <td>결과2-3</td>
        </tr>

      </tbody>
    </table>


<!-- Conclusion -->    
    <h2>4. Conclusion</h2>



<!-- Reference -->    
    <h2>5. Reference</h2>




  </div>
</div>


<div class="pagination">
  <a href="{{ '/transformer_variants' | relative_url }}" class="btn-prev"></a>
  <a href="{{ '/eff_train' | relative_url }}" class="btn-next"></a>
</div>